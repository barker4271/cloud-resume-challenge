<%--
  blog.ejs

  Renders the Blog page.
  - Displays a list of blog posts fetched from Cosmos DB
  - Shows a friendly message when no posts exist
  - Provides a button to create a new blog post
--%>

<section class="content">

  <header style="margin-bottom: 30px;">
    <h1>Blog</h1>
    <p>Thoughts from the Wookiee mind.</p>

    <a href="/blog/new"
       style="
         display: inline-block;
         margin-top: 15px;
         padding: 10px 20px;
         background: #1976d2;
         color: white;
         text-decoration: none;
         border-radius: 6px;
       ">
      + New Blog Post
    </a>
  </header>

  <%--
    If there are NO posts, show a friendly message
  --%>
  <% if (!posts || posts.length === 0) { %>

    <p style="margin-top: 40px; font-style: italic;">
      No blog posts yet. The archives are emptyâ€¦ for now.
    </p>

  <% } else { %>

    <%--
      Render each blog post
    --%>
    <% posts.forEach(function(post) { %>

      <article style="
        margin-bottom: 40px;
        padding-bottom: 20px;
        border-bottom: 1px solid #444;
      ">

        <h2><%= post.topic %></h2>

        <p style="color: #aaa; font-size: 0.9rem;">
          <%= new Date(post.createdAt).toLocaleString() %>
        </p>

        <p style="margin-top: 15px; line-height: 1.6;">
          <%= post.body %>
        </p>

      </article>

    <% }); %>

  <% } %>

</section>
